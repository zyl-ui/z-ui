<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>介绍 | 最有料 UI</title>
    <meta name="generator" content="VuePress 1.8.3">
    <link rel="icon" href="/zyl-ui/favicon.ico">
    <meta name="description" content="一个基于 Vue 和 elementUI 的 最有料 UI PC端业务组件库">
    
    <link rel="preload" href="/zyl-ui/assets/css/0.styles.98598582.css" as="style"><link rel="preload" href="/zyl-ui/assets/js/app.5df11ba7.js" as="script"><link rel="preload" href="/zyl-ui/assets/js/2.50f0673b.js" as="script"><link rel="preload" href="/zyl-ui/assets/js/3.452d22a9.js" as="script"><link rel="prefetch" href="/zyl-ui/assets/js/10.ce8ac854.js"><link rel="prefetch" href="/zyl-ui/assets/js/11.f29ce48e.js"><link rel="prefetch" href="/zyl-ui/assets/js/12.2e647f7c.js"><link rel="prefetch" href="/zyl-ui/assets/js/13.540d9486.js"><link rel="prefetch" href="/zyl-ui/assets/js/14.f6fb3afb.js"><link rel="prefetch" href="/zyl-ui/assets/js/15.35c1e609.js"><link rel="prefetch" href="/zyl-ui/assets/js/16.602c4319.js"><link rel="prefetch" href="/zyl-ui/assets/js/17.1bc893d5.js"><link rel="prefetch" href="/zyl-ui/assets/js/18.b56f6697.js"><link rel="prefetch" href="/zyl-ui/assets/js/19.437e73c0.js"><link rel="prefetch" href="/zyl-ui/assets/js/20.c35231b7.js"><link rel="prefetch" href="/zyl-ui/assets/js/21.ed1e4842.js"><link rel="prefetch" href="/zyl-ui/assets/js/22.585d05f4.js"><link rel="prefetch" href="/zyl-ui/assets/js/23.e7609aa8.js"><link rel="prefetch" href="/zyl-ui/assets/js/24.c899def9.js"><link rel="prefetch" href="/zyl-ui/assets/js/25.9927d520.js"><link rel="prefetch" href="/zyl-ui/assets/js/26.aa4faf9b.js"><link rel="prefetch" href="/zyl-ui/assets/js/27.4cf71ccf.js"><link rel="prefetch" href="/zyl-ui/assets/js/28.f842212e.js"><link rel="prefetch" href="/zyl-ui/assets/js/4.b15a3790.js"><link rel="prefetch" href="/zyl-ui/assets/js/5.9c24e305.js"><link rel="prefetch" href="/zyl-ui/assets/js/6.9179d9f4.js"><link rel="prefetch" href="/zyl-ui/assets/js/7.68bc259c.js"><link rel="prefetch" href="/zyl-ui/assets/js/8.b366248a.js"><link rel="prefetch" href="/zyl-ui/assets/js/9.56202247.js">
    <link rel="stylesheet" href="/zyl-ui/assets/css/0.styles.98598582.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/zyl-ui/" class="home-link router-link-active"><img src="/zyl-ui/favicon.ico" alt="最有料 UI" class="logo"> <span class="site-name can-hide">最有料 UI</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/zyl-ui/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="http://192.168.140.130:8099/zhanghan/zyl-ui" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitLab
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/zyl-ui/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="http://192.168.140.130:8099/zhanghan/zyl-ui" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitLab
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/zyl-ui/docs/introduce/" aria-current="page" class="active sidebar-link">介绍</a><ul class="sidebar-sub-headers"></ul></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>入门</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/zyl-ui/docs/install/" class="sidebar-link">安装</a></li><li><a href="/zyl-ui/docs/get-start/" class="sidebar-link">快速上手</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>通用业务组件</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/zyl-ui/docs/components/zylSyncButton.html" class="sidebar-link">zylSyncButton - 异步 loading 按钮</a></li><li><a href="/zyl-ui/docs/components/zylToast.html" class="sidebar-link">zylToast - 消息提示</a></li><li><a href="/zyl-ui/docs/components/zylSpread.html" class="sidebar-link">zylSpread - 展开收起</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>通用工具函数</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/zyl-ui/docs/plugins/zylUseFormValids.html" class="sidebar-link">zylUseFormValids 全局表单字段校验</a></li><li><a href="/zyl-ui/docs/plugins/zylUseFilters.html" class="sidebar-link">zylUseFilters 全局过滤函数</a></li><li><a href="/zyl-ui/docs/plugins/zylUseTools.html" class="sidebar-link">zylUseTools 全局通用工具类</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="介绍"><a href="#介绍" class="header-anchor">#</a> 介绍</h1> <p>先分享两个有趣视频</p> <video width="320" height="240" controls="controls"><source src="/zyl-ui/assets/media/icu.bb3c43b3.mp4" type="video/mp4"></video> <video width="320" height="240" controls="controls"><source src="/zyl-ui/assets/media/product.cb60eb17.mp4" type="video/mp4"></video> <h3 id="初衷"><a href="#初衷" class="header-anchor">#</a> 初衷</h3> <p>我们经常会发现很多项目内封装的组件和工具类<strong>风格和交互逻辑是一样的</strong>。此前的做法是从一个项目 copy 到另一个项目去使用，或者接手的项目的人不知道项目有封装过类似的组件自己又封装了一个。就造成了每个项目是独立的，维护比较困难，UI 交互和风格方面也不能统一。</p> <p><strong>基于这个痛点，我们可以把这些通用型业务组件和工具类从每个项目里抽离出来，发布成一个 npm 包统一进行管理下载和版本迭代，并且提供文档说明，对于接手项目的人来说会比较友好，也能减少重复造轮子和开发工作量，UI 交互和风格方面较容易达成统一。</strong></p> <p>最后，欢迎大家一起来完善和共享这个业务组件库，让它后续更方便为开发提效所用。</p> <h3 id="组件库特点"><a href="#组件库特点" class="header-anchor">#</a> 组件库特点</h3> <p>业务组件基于成熟的 UI 组件库进行二次封装 <a href="http:#element-cn.eleme.io/#/zh-CN" target="_blank" rel="noopener noreferrer">ElementUI<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="聊一聊组件库基本原理和架构"><a href="#聊一聊组件库基本原理和架构" class="header-anchor">#</a> 聊一聊组件库基本原理和架构</h3> <p>搭建一个基本组件库流程主要有以下几个过程（<strong>当然一个成熟的组件库还为开发体验和优化做了很多边缘适配和拓展，如单元测试、自动化生成构建、为组件设置命名空间等等，这里就不进行一一介绍，我们先实现一个最基础的版本</strong>）：</p> <ul><li>1、编写组件库的架手架环境搭建（这里采用 vue-cli）</li> <li>2、组件库的内容编写（这里采用 vue2 语法）</li> <li>3、组件库的入口文件暴露（利用 Vue.use 的 install 方法）</li> <li>4、组件库的入口打包配置处理（这里采用 webpack，rollup 会更适合）</li> <li>5、组件库文档搭建（这里采用 vuepress）</li> <li>6、组件库打包发布 npm</li></ul> <h4 id="vue-cli-初始化项目"><a href="#vue-cli-初始化项目" class="header-anchor">#</a> vue-cli 初始化项目</h4> <div class="language-bash extra-class"><pre class="language-bash"><code>vue create zyl-ui
</code></pre></div><h4 id="目录结构及配置"><a href="#目录结构及配置" class="header-anchor">#</a> 目录结构及配置</h4> <div class="language-bash extra-class"><pre class="language-bash"><code>config
│  └─config.build.js <span class="token comment"># 生产环境的webpack配置</span>
│  └─config.dev.js <span class="token comment"># 开发环境的webpack配置</span>
│
doc 组件库文档 <span class="token comment"># 文档配置可参考 [vuepress官方文档](https://v1.vuepress.vuejs.org/zh/)</span>
│
examples <span class="token comment"># 实时调试组件展示效果使用</span>
│  └─App.vue <span class="token comment">#主入口页面</span>
│  └─main.js <span class="token comment">#主入口js引入</span>
│
lib <span class="token comment"># 打包后的产物</span>
│
packages <span class="token comment"># 需要打包的内容</span>
│  │
│  └─ components <span class="token comment"># 组件</span>
│  │      │
│  │      └─zylSyncButton
│  │      │ └─src
│  │      │ │ └─index.vue <span class="token comment"># 组件内容</span>
│  │      │ └─index.js <span class="token comment"># 单组件暴露入口</span>
│  │      │
│  │      └─zylToast <span class="token comment"># 组件</span>
│  │      │ └─src
│  │      │ │  └─index.vue <span class="token comment"># 组件内容</span>
│  │      │ └─index.js <span class="token comment"># 单组件暴露入口</span>
│  │      └─<span class="token punctuation">..</span>.
│  │
│  └─ plugins <span class="token comment"># 插件</span>
│  │      │
│  │      └─zylUseFormValids
│  │      │ │
│  │      │ └─index.js <span class="token comment"># 单组件暴露入口</span>
│  │      │
│  │      └─zylUseFilters <span class="token comment"># 组件</span>
│  │      │ │
│  │      │ └─index.js <span class="token comment"># 单组件暴露入口</span>
│  │      │
│  │      └─zylUseTools <span class="token comment"># 组件</span>
│  │      │ │
│  │      │ └─index.js <span class="token comment"># 单组件暴露入口</span>
│  │      └─<span class="token punctuation">..</span>.
│  └─ index.js <span class="token comment"># 总暴露入口</span>
│
.public <span class="token comment"># 存放一些静态文件</span>
.eslintignore <span class="token comment"># eslint需要忽略校验的文件或目录</span>
.gitignore <span class="token comment"># git提交需要忽略校验的文件或目录</span>
.npmrc <span class="token comment"># 设置 package.json 中依赖包的安装来源</span>
babel.config.js <span class="token comment"># babel转译的配置文件</span>
jsconfig.json <span class="token comment"># 优化ide开发体验，比如文件内地址关联跳转等</span>
package.json <span class="token comment"># 依赖包、脚本指令等重要信息</span>
yarn.lock <span class="token comment"># yarn 锁定包版本</span>
README.md  <span class="token comment"># 项目说明文档</span>
vue.config.js  <span class="token comment">#vue-cli和webpack打包相关配置项</span>
</code></pre></div><h4 id="组件库单个文件入口暴露-用于按需引入"><a href="#组件库单个文件入口暴露-用于按需引入" class="header-anchor">#</a> 组件库单个文件入口暴露（用于按需引入）</h4> <p><code>src/packages/components/zylSyncButton/index.js</code></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// src/packages/components/zylSyncButton/index.js</span>

<span class="token keyword">import</span> zylSyncButton <span class="token keyword">from</span> <span class="token string">'./src/index.vue'</span>

zylSyncButton<span class="token punctuation">.</span><span class="token function-variable function">install</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">Vue</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  Vue<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span>zylSyncButton<span class="token punctuation">.</span>name<span class="token punctuation">,</span> zylSyncButton<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> zylSyncButton
</code></pre></div><h4 id="组件库总入口暴露"><a href="#组件库总入口暴露" class="header-anchor">#</a> 组件库总入口暴露</h4> <p><code>src/packages/index.js</code></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// src/packages/index.js</span>

<span class="token comment">// 引入插件</span>
<span class="token keyword">import</span> zylUseToast <span class="token keyword">from</span> <span class="token string">'./plugins/zylUseToast'</span>
<span class="token keyword">import</span> zylUseFormValids <span class="token keyword">from</span> <span class="token string">'./plugins/zylUseFormValids'</span>
<span class="token keyword">const</span> plugins <span class="token operator">=</span> <span class="token punctuation">[</span>zylUseToast<span class="token punctuation">,</span> zylUseFormValids<span class="token punctuation">]</span>

<span class="token comment">// 引入组件</span>
<span class="token keyword">import</span> zylAttr <span class="token keyword">from</span> <span class="token string">'./components/zylAttr'</span>
<span class="token keyword">import</span> zylDemoBlock <span class="token keyword">from</span> <span class="token string">'./components/zylDemoBlock'</span>
<span class="token keyword">const</span> components <span class="token operator">=</span> <span class="token punctuation">[</span>zylAttr<span class="token punctuation">,</span> zylDemoBlock<span class="token punctuation">]</span>

<span class="token comment">// 定义 install 方法，接收 Vue 作为参数。如果使用 use 注册插件，则所有的组件都将被注册</span>
<span class="token keyword">const</span> <span class="token function-variable function">install</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">Vue</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 判断是否安装</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>install<span class="token punctuation">.</span>installed<span class="token punctuation">)</span> <span class="token keyword">return</span>
  <span class="token comment">// 批量注册全局插件</span>
  plugins<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">plugin</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>plugin<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token comment">// 批量注册全局组件</span>
  components<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">component</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    Vue<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span>component<span class="token punctuation">.</span>name<span class="token punctuation">,</span> component<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 判断是否是直接引入文件,有可能组件会通过script标签引入，如&lt;script src='https://xxx/zyl-ui'&gt;&lt;/script&gt;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> window <span class="token operator">!==</span> <span class="token string">'undefined'</span> <span class="token operator">&amp;&amp;</span> window<span class="token punctuation">.</span>Vue<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">install</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>Vue<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 暴露安装方法，用于全量引入,导出的对象必须具有 install，才能被 Vue.use() 方法安装</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> install
<span class="token comment">// 暴露安装方法，用于按需引入</span>
<span class="token keyword">export</span> <span class="token punctuation">{</span> install<span class="token punctuation">,</span> zylUseToast<span class="token punctuation">,</span> zylUseFormValids<span class="token punctuation">,</span> zylAttr<span class="token punctuation">,</span> zylDemoBlock <span class="token punctuation">}</span>
</code></pre></div><p>以插件的方式使用组件：</p> <p><code>examples/main.js</code></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// examples/main.js</span>

<span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">import</span> ElementUI <span class="token keyword">from</span> <span class="token string">'element-ui'</span> <span class="token comment">// 全局引入</span>
<span class="token keyword">import</span> <span class="token string">'element-ui/lib/theme-chalk/index.css'</span>

<span class="token comment">// 引入zylUI组件</span>
<span class="token keyword">import</span> zylUI <span class="token keyword">from</span> <span class="token string">'@packages'</span>
<span class="token comment">// 注册组件库</span>
Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>zylUI<span class="token punctuation">)</span>
</code></pre></div><p>@packages 为 <code>config/config.dev.js</code> 别名配置</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// config/config.dev.js</span>

<span class="token comment">// 扩展 webpack 配置</span>
<span class="token function-variable function">chainWebpack</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">config</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  config<span class="token punctuation">.</span>resolve<span class="token punctuation">.</span>alias<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'@'</span><span class="token punctuation">,</span> <span class="token string">'/examples'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'@packages'</span><span class="token punctuation">,</span> <span class="token string">'/packages'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="组件库的入口打包配置处理"><a href="#组件库的入口打包配置处理" class="header-anchor">#</a> 组件库的入口打包配置处理</h4> <p><code>vue.config.js</code> 不同环境选择不通编译配置</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// vue.config.js</span>

<span class="token comment">// 开发环境（编译构建的是examples文件夹内的东西，用于组件库开发调试）</span>
<span class="token keyword">const</span> devConfig <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./config/config.dev'</span><span class="token punctuation">)</span>

<span class="token comment">// 打包环境（编译构建的是packages文件夹内的东西，用于打包组件发布npm）</span>
<span class="token keyword">const</span> buildConfig <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./config/config.build'</span><span class="token punctuation">)</span>

<span class="token comment">// 根据运行环境选择编译配置</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">===</span> <span class="token string">'production'</span> <span class="token operator">?</span> buildConfig <span class="token operator">:</span> devConfig
</code></pre></div><p><code>config/config.build.js</code> 生产环境编译 packages 文件夹下内容（配置从哪里打包到哪里）</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// config/config.build.js</span>

<span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> join <span class="token operator">=</span> path<span class="token punctuation">.</span>join
<span class="token comment">//  获取基于当前路径的目标文件</span>
<span class="token keyword">const</span> <span class="token function-variable function">resolve</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">dir</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'../'</span><span class="token punctuation">,</span> dir<span class="token punctuation">)</span>

<span class="token comment">// 获取组件库的每个包的入口文件地址</span>
<span class="token keyword">function</span> <span class="token function">getComponentEntries</span><span class="token punctuation">(</span><span class="token parameter">path</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> files <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readdirSync</span><span class="token punctuation">(</span><span class="token function">resolve</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">)</span>

  <span class="token keyword">const</span> componentEntries <span class="token operator">=</span> files<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">fileObj<span class="token punctuation">,</span> item</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">//  文件路径</span>
    <span class="token keyword">const</span> itemPath <span class="token operator">=</span> <span class="token function">join</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> item<span class="token punctuation">)</span>
    <span class="token comment">//  在文件夹中</span>
    <span class="token keyword">const</span> isDir <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">statSync</span><span class="token punctuation">(</span>itemPath<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isDirectory</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">const</span> <span class="token punctuation">[</span>name<span class="token punctuation">,</span> suffix<span class="token punctuation">]</span> <span class="token operator">=</span> item<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span>

    <span class="token comment">// 文件中的入口文件</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>isDir<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      fileObj<span class="token punctuation">[</span>item<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token function">join</span><span class="token punctuation">(</span>itemPath<span class="token punctuation">,</span> <span class="token string">'index.js'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//  文件夹外的入口文件</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>suffix <span class="token operator">===</span> <span class="token string">'js'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      fileObj<span class="token punctuation">[</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>itemPath<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> fileObj
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token keyword">return</span> componentEntries
<span class="token punctuation">}</span>

<span class="token keyword">const</span> buildConfig <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">//  输出文件目录</span>
  <span class="token literal-property property">outputDir</span><span class="token operator">:</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'lib'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token literal-property property">productionSourceMap</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token comment">//  webpack配置</span>
  <span class="token literal-property property">configureWebpack</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">//  入口文件(这里获取到的是每个独立包的入口文件地址数组)</span>
    <span class="token literal-property property">entry</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token comment">// 全量引入的文件入口</span>
      <span class="token literal-property property">index</span><span class="token operator">:</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'packages'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token comment">// 按需引入的文件入口</span>
      <span class="token operator">...</span><span class="token function">getComponentEntries</span><span class="token punctuation">(</span><span class="token string">'packages/plugins'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token operator">...</span><span class="token function">getComponentEntries</span><span class="token punctuation">(</span><span class="token string">'packages/components'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">//  输出配置</span>
    <span class="token literal-property property">output</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token comment">//  主入口文件名称</span>
      <span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">'[name]/index.js'</span><span class="token punctuation">,</span>
      <span class="token comment">//  构建依赖类型</span>
      <span class="token literal-property property">libraryTarget</span><span class="token operator">:</span> <span class="token string">'umd'</span><span class="token punctuation">,</span>
      <span class="token comment">//  库中被导出的项</span>
      <span class="token literal-property property">libraryExport</span><span class="token operator">:</span> <span class="token string">'default'</span><span class="token punctuation">,</span>
      <span class="token comment">//  引用时的依赖名</span>
      <span class="token literal-property property">library</span><span class="token operator">:</span> <span class="token string">'zyl-ui'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">css</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">sourceMap</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token comment">// 是否将组件中的css提取至一个独立的css，库构建时可以设置为false，免得用户需要自己导入css</span>
    <span class="token literal-property property">extract</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token comment">// extract: {</span>
    <span class="token comment">//   filename: '[name]/index.css',</span>
    <span class="token comment">// },</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">chainWebpack</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">config</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// 一些构建优化</span>
    config<span class="token punctuation">.</span>optimization<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token string">'splitChunks'</span><span class="token punctuation">)</span>
    config<span class="token punctuation">.</span>plugins<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token string">'copy'</span><span class="token punctuation">)</span>
    config<span class="token punctuation">.</span>plugins<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token string">'preload'</span><span class="token punctuation">)</span>
    config<span class="token punctuation">.</span>plugins<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token string">'prefetch'</span><span class="token punctuation">)</span>
    config<span class="token punctuation">.</span>plugins<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token string">'html'</span><span class="token punctuation">)</span>
    config<span class="token punctuation">.</span>plugins<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token string">'hmr'</span><span class="token punctuation">)</span>
    config<span class="token punctuation">.</span>entryPoints<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token string">'app'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> buildConfig
</code></pre></div><p><code>package.json</code> 执行编译指令 <code>npm run build vue-cli-service</code> 内部读取 <code>vue.config.js</code> --&gt; <code>config/config.build.js</code> 进行编译打包为 <code>UMD规范</code> 在 <code>lib</code> 文件夹下</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// package.json</span>

<span class="token string-property property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token string-property property">&quot;serve&quot;</span><span class="token operator">:</span> <span class="token string">&quot;vue-cli-service serve&quot;</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;build&quot;</span><span class="token operator">:</span> <span class="token string">&quot;vue-cli-service build&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><p><img src="/zyl-ui/assets/img/lib.86c192a0.jpg" alt="lib目录结构"></p> <ul><li>配置运行入口和包信息</li></ul> <p><code>package.json</code></p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token comment">// package.json</span>

<span class="token punctuation">{</span>
  <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;@zuiyouliao/zyl-ui&quot;</span><span class="token punctuation">,</span> <span class="token comment">//包名</span>
  <span class="token property">&quot;version&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0.1.0&quot;</span><span class="token punctuation">,</span> <span class="token comment">//版本号</span>
  <span class="token property">&quot;private&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">//是否私有化部署</span>
  <span class="token property">&quot;author&quot;</span><span class="token operator">:</span> <span class="token string">&quot;zly &lt;294333196@qq.com&gt;&quot;</span><span class="token punctuation">,</span> <span class="token comment">//作者</span>
  <span class="token property">&quot;license&quot;</span><span class="token operator">:</span> <span class="token string">&quot;MIT&quot;</span><span class="token punctuation">,</span> <span class="token comment">//开源协议</span>
  <span class="token property">&quot;description&quot;</span><span class="token operator">:</span> <span class="token string">&quot;一个基于 Vue 和 elementUI 的 最有料 UI PC端业务组件库&quot;</span><span class="token punctuation">,</span> <span class="token comment">//项目描述</span>
  <span class="token comment">// 上传npm主页的一些关键文件识别</span>
  <span class="token property">&quot;directories&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;doc&quot;</span><span class="token operator">:</span> <span class="token string">&quot;docs&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;example&quot;</span><span class="token operator">:</span> <span class="token string">&quot;examples&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;lib&quot;</span><span class="token operator">:</span> <span class="token string">&quot;lib&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// 上传npm的文件白名单（哪些需要上传）</span>
  <span class="token property">&quot;files&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;packages&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;lib&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;docs&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token comment">// 引用包的主入口地址</span>
  <span class="token property">&quot;main&quot;</span><span class="token operator">:</span> <span class="token string">&quot;lib/index&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>将项目 link 到全局下做一个快捷方式映射让本地的包就好像 install 过一样，可以直接使用。</li></ul> <p>在 zyl-ui 项目根目录下执行</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">link</span>
</code></pre></div><p>然后就可以在<code>examples/main.js</code> 愉快的使用打包结果</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// examples/main.js</span>

<span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">import</span> ElementUI <span class="token keyword">from</span> <span class="token string">'element-ui'</span> <span class="token comment">// 全局引入</span>
<span class="token keyword">import</span> <span class="token string">'element-ui/lib/theme-chalk/index.css'</span>
Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>ElementUI<span class="token punctuation">)</span>

<span class="token comment">// 引入zylUI组件</span>
<span class="token keyword">import</span> zylUI <span class="token keyword">from</span> <span class="token string">'@zuiyouliao/zyl-ui'</span>
<span class="token comment">// 注册组件库</span>
Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>zylUI<span class="token punctuation">)</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p><code>npm link</code> 操作会在项目的 node_modules 目录下创建一个 module1 的超链接（类似 Windows 的快捷方式），链接到 project_npmlink/module1。</p> <p>生成的虚拟包名会根据 module1 的 package.json 进行指定。</p></div> <h4 id="组件库文档搭建"><a href="#组件库文档搭建" class="header-anchor">#</a> 组件库文档搭建</h4> <p>VuePress 是 Vue 驱动的静态网站生成器。支持在 Markdown 中使用 Vue 组件，简洁，高性能。当然你也可以使用其他的文档生成器，如 Docz、Storybook 等。</p> <p>文档安装和配置可参考 <a href="https://v1.vuepress.vuejs.org/zh/" target="_blank" rel="noopener noreferrer">vuepress 官方文档<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><code>package.json</code> 安装完可在项目根目录配置启动和构建脚本</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token comment">// package.json</span>

<span class="token punctuation">{</span>
  <span class="token property">&quot;doc:dev&quot;</span><span class="token operator">:</span> <span class="token string">&quot;vuepress dev doc&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;doc:build&quot;</span><span class="token operator">:</span> <span class="token string">&quot;vuepress build doc&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><code>.vuepress/enhanceApp.js</code> 相当于 mian.js 为项目入口，可在此安装插件</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// vuepress/enhanceApp.js</span>

<span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">import</span> ElementUI <span class="token keyword">from</span> <span class="token string">'element-ui'</span> <span class="token comment">// 全局引入</span>
<span class="token keyword">import</span> <span class="token string">'element-ui/lib/theme-chalk/index.css'</span>

<span class="token comment">// 引入未编译的代码可以边写文档边调试</span>
<span class="token keyword">import</span> zylUI <span class="token keyword">from</span> <span class="token string">'../../packages'</span>

<span class="token comment">// 也可以引入zylUI组件打包产物 前提要 npm link</span>
<span class="token comment">// import zylUI from '@zuiyouliao/zyl-ui'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> Vue <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>ElementUI<span class="token punctuation">)</span>
  Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>zylUI<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="发布组件到-npm"><a href="#发布组件到-npm" class="header-anchor">#</a> 发布组件到 npm</h4> <p>发布前，需要确保 <code>package.json</code> 中这些字段。</p> <ol><li>name</li></ol> <p>它是发布到 npm 上的包名，也是安装时的包名。请保证它的唯一性，可以到 npm 上先搜索一下，是否已经存在。</p> <ol start="2"><li>version</li></ol> <p>版本号，遵守语义化版本规则。每次新发布都要进行更改。可以使用 <code>npm version [major.minor.patch]</code> 命令来执行更新。</p> <ol start="3"><li>main</li></ol> <p>是包的入口。</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">npm</span> addUser <span class="token comment"># 如果没有用户名就注册一个，否则直接登录</span>
<span class="token function">npm</span> login <span class="token comment"># 登录，输入密码</span>
<span class="token function">npm</span> publish <span class="token comment"># 发布，zyl-ui根目录下执行</span>
</code></pre></div><p>等过一会儿，就可以到 <a href="https://www.npmjs.com/" target="_blank" rel="noopener noreferrer">npm<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 上搜索到发布的包 <a href="https://www.npmjs.com/package/@zuiyouliao/zyl-ui" target="_blank" rel="noopener noreferrer">@zuiyouliao/zyl-ui<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 。这里我创建了一个<code>zuiyouliao</code>组织可以使用组织的命名空间<code>@zuiyouliao/zyl-ui</code>，其他协作者只需要被邀请加入组织就可以发布 这个 npm 组件包了</p> <p><img src="/zyl-ui/assets/img/npm.8b99428d.jpg" alt="npm"></p> <p>接下来你就可以 <code>npm install @zuiyouliao/zyl-ui</code> 安装并使用你自己的组件库了。</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">12/4/2022, 8:51:54 PM</span></div></footer> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/zyl-ui/docs/install/">
        安装
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/zyl-ui/assets/js/app.5df11ba7.js" defer></script><script src="/zyl-ui/assets/js/2.50f0673b.js" defer></script><script src="/zyl-ui/assets/js/3.452d22a9.js" defer></script>
  </body>
</html>
